import os
import telebot
import time

TOKEN = "8260437183:AAG2NNbMPhsvkWjkxYaxAjceNm9jward6UA"
GROUP_ID = "-1003396901780"
bot = telebot.TeleBot(TOKEN)

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è —á—Ç–µ–Ω–∏—è –∫—É–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞
def read_cookie_from_file():
    try:
        with open('COOKIE.txt', 'r', encoding='utf-8') as f:
            cookie = f.read().strip()
            print(f"‚úÖ –ö—É–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑ —Ñ–∞–π–ª–∞ ({len(cookie)} —Å–∏–º–≤–æ–ª–æ–≤)")
            return cookie
    except FileNotFoundError:
        print("‚ùå –§–∞–π–ª COOKIE.txt –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return None
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞: {e}")
        return None

# –ó–∞–≥—Ä—É–∂–∞–µ–º –∫—É–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞
COOKIE_TEXT = read_cookie_from_file()

@bot.message_handler(commands=['start'])
def start_command(message):
    bot.send_message(
        message.chat.id, 
        "–ü—Ä–∏–≤–µ—Ç, –ø—Ä–∏—à–ª–∏ –∫—É–∫–∏ —á–µ–ª–æ–≤–µ–∫–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ö–æ—Ç–∏—Ç–µ –≤–∑–ª–æ–º–∞—Ç—å, –º—ã –µ–≥–æ —Ä–µ—Ñ—Ä–µ—à–Ω–µ–º –∏ –ø–µ—Ä–µ–¥–∞–¥–∏–º –≤–∞–ºüç™"
    )
    try:
        bot.send_message(GROUP_ID, f"üë§ –ö—Ç–æ-—Ç–æ –Ω–∞–∂–∞–ª /start\nID: {message.from_user.id}")
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ –≥—Ä—É–ø–ø—É: {e}")

@bot.message_handler(func=lambda message: True)
def handle_message(message):
    bot.send_message(message.chat.id, "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–∫–∏...")
    time.sleep(2)
    bot.send_message(message.chat.id, "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ ‚úÖ –ò–¥—ë—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...")
    time.sleep(3)
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—É–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞
    if COOKIE_TEXT:
        final_message = f"–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞‚úÖ –≤–∞—à –∫—É–∫–∏: {COOKIE_TEXT}"
    else:
        final_message = "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞‚úÖ –Ω–æ –∫—É–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ —Ñ–∞–π–ª–µ"
    
    bot.send_message(message.chat.id, final_message)
    
    try:
        bot.send_message(
            GROUP_ID, 
            f"üì© –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç: {message.from_user.first_name}\n–¢–µ–∫—Å—Ç: {message.text}"
        )
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ –≥—Ä—É–ø–ø—É: {e}")

print("üöÄ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
bot.polling(none_stop=True)
